#!/bin/bash
source <(printf 'IyEvYmluL2Jhc2gKIyAtKi0gRU5DT0RJTkc6IFVURi04IC0qLQpfTVNHX0VYRUNVVEVEX0FTX1NVUEVSVVNFUj0iRXN0ZSBzY3JpcHQgbmVjZXNpdGEgc2VyIGVqZWN1dGFkbyBjb21vIHN1cGVydXN1YXJpby4iCl9NU0dfVVJMPSJVUkwiCl9NU0dfRVJST1I9IkVycm9yIgpfTVNHX0VSUk9SX0NPREU9IkPDs2RpZ28gZGUgZXJyb3IiCl9NU0dfTk9UX0ZPVU5EPSJObyBlbmNvbnRyYWRvIgpfTVNHX0VSUk9SX1JFVFJJRVZJTkdfR0RSSVZFX1JFTEVBU0VTPSJPY3VycmnDsyB1biBlcnJvciBvYnRlbmllbmRvIGxhIGluZm9ybWFjacOzbiBkZSBsYXMgcmVsZWFzZXMgZGUgR29vZ2xlIERyaXZlIGRlIGxhIEFQSSBkZSBHaXRodWIuIgpfTVNHX0VSUk9SX1BBUlNJTkdfUEVOVUxUSU1BVEVfR0RSSVZFX1JFTEVBU0VTX1ZFUlNJT049Ik9jdXJyacOzIHVuIGVycm9yIHBhcnNlYW5kbyBsYSB2ZXJzacOzbiBkZSBsYSBwZW7Dumx0aW1hIHJlbGVhc2UgZGUgR29vZ2xlIERyaXZlIGRlIGxhIEFQSSBkZSBHaXRodWIuIgpfTVNHX0VSUk9SX1JFVFJJRVZJTkdfTEFTVF9HRFJJVkVfUkVMRUFTRV9WRVJTSU9OPSJPY3VycmnDsyB1biBlcnJvciBvYnRlbmllbmRvIGxhIHZlcnNpw7NuIGRlIGxhIMO6bHRpbWEgcmVsZWFzZSBkZSBHb29nbGUgRHJpdmUuIgpfTVNHX0VSUk9SX0RPV05MT0FESU5HX0dEUklWRT0iT2N1cnJpw7MgdW4gZXJyb3IgZGVzY2FyZ2FuZG8gR29vZ2xlIERyaXZlIgpfTVNHX0NIRUNLSU5HX0dEUklWRV9DTElFTlQ9IkNvbXByb2JhbmRvIGVsIGNsaWVudGUgR29vZ2xlIERyaXZlLi4uIgpfTVNHX1JFVFJJRVZJTkdfTEFTVF9BVkFJTEFCTEVfVkVSU0lPTj0iT2J0ZW5pZW5kbyBsYSDDumx0aW1hIHZlcnNpw7NuIGRpc3BvbmlibGUuLi4iCl9NU0dfRE9XTkxPQURJTkdfR0RSSVZFX0NMSUVOVD0iRGVzY2FyZ2FuZG8gZWwgY2xpZW50ZSBkZSBHb29nbGUgRHJpdmUuLi4iCl9NU0dfVVBEQVRJTkdfR0RSSVZFPSJBY3R1YWxpemFuZG8gR29vZ2xlIERyaXZlIgpfTVNHX0ZPVU5EX0dEUklWRV9JTlNUQUxMRUQ9IkVuY29udHJhZG8gR29vZ2xlIERyaXZlIGluc3RhbGFkbyBlbiBlbCBzaXN0ZW1hIgppZiBbWyAkKC91c3IvYmluL2lkIC11KSAtbmUgMCBdXTsgdGhlbgogIHByaW50ZiAiJXNcbiIgIiRfTVNHX0VYRUNVVEVEX0FTX1NVUEVSVVNFUiIgPiYyCiAgZXhpdCAxCmZpOwpJTkRFTlRfU1RSSU5HPSIiCkdJVEhVQl9BUElfQ1VSTF9BVVRIPSIiCmlmIFsgLW4gIiRHSVRIVUJfVVNFUk5BTUUiIF0gJiYgWyAtbiAiJEdJVEhVQl9UT0tFTiIgXTsgdGhlbgogIEdJVEhVQl9BUElfQ1VSTF9BVVRIPSIkR0lUSFVCX1VTRVJOQU1FOiRHSVRIVUJfVE9LRU4iCmZpOwpmb3IgYXJnIGluICIkQCI7IGRvCiAgY2FzZSAkYXJnIGluCiAgICAtLWluZGVudCkKICAgIHNoaWZ0CiAgICBJTkRFTlRfU1RSSU5HPSQxCiAgICBzaGlmdAogICAgOzsKICBlc2FjCmRvbmUKZnVuY3Rpb24gcHJpbnRQcmVwZW5kZWRTdGRvdXQoKSB7CiAgcHJpbnRmICIlcyIgIiRJTkRFTlRfU1RSSU5HIgp9CmZ1bmN0aW9uIGluc3RhbGxTY3JpcHREZXBlbmRlbmNpZXMoKSB7CiAgSU5TVEFMTEFUSU9OX0RFUEVOREVOQ0lFUz0oImN1cmwiICJqcSIpCiAgZm9yIERFUCBpbiAiJHtJTlNUQUxMQVRJT05fREVQRU5ERU5DSUVTW0BdfSI7IGRvCiAgICBpZiBbWyAiJChzdWRvIGRwa2cgLXMgIiRERVAiIDI+IC9kZXYvbnVsbCB8IGdyZXAgU3RhdHVzKSIgIT0gIlN0YXR1czogaW5zdGFsbCBvayBpbnN0YWxsZWQiIF1dOyB0aGVuCiAgICAgIHN1ZG8gYXB0LWdldCBpbnN0YWxsIC15IC1xcXEgIiRERVAiID4gL2Rldi9udWxsIHx8IGV4aXQgJD8KICAgIGZpOwogIGRvbmUKfQpfR0VUX0dEUklWRV9WRVJTSU9OX0lOREVYPTAKX0dFVF9HRFJJVkVfVkVSU0lPTl80MDRfQVRURU1QVFM9MApfR0VUX0dEUklWRV9WRVJTSU9OXzQwNF9NQVhfQVRURU1QVFM9MTAKZnVuY3Rpb24gY2hlY2tHb29nbGVEcml2ZVZlcnNpb25Ub0Rvd25sb2FkRXhpc3RzKCkgewogIF9ET1dOTE9BRF9HRFJJVkVfVVJMPSJodHRwczovL2dpdGh1Yi5jb20vZ2RyaXZlLW9yZy9nZHJpdmUvcmVsZWFzZXMvZG93bmxvYWQvJF9HRFJJVkVfTEFTVEVTVF9WRVJTSU9OL2dkcml2ZS1saW51eC14NjQiCiAgX0RPV05MT0FEX0dEUklWRV9VUkxfRVhJU1RTPTAKICBpZiBjdXJsIC0tb3V0cHV0IC9kZXYvbnVsbCAtLXNpbGVudCAtLWhlYWQgLS1mYWlsICIkX0RPV05MT0FEX0dEUklWRV9VUkwiOyB0aGVuCiAgICBfRE9XTkxPQURfR0RSSVZFX1VSTF9FWElTVFM9MQogIGZpOwp9Cl9HRVRfR0RSSVZFX0xBVEVTVF9WRVJTSU9OX0FUVEVNUFRTPTAKX0dFVF9HRFJJVkVfTEFURVNUX1ZFUlNJT05fTUFYX0FUVEVNUFRTPTUKX0dFVF9HRFJJVkVfTEFURVNUX1ZFUlNJT05fVVJMPWh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3MvZ2RyaXZlLW9yZy9nZHJpdmUvcmVsZWFzZXMKZnVuY3Rpb24gZ2V0R29vZ2xlRHJpdmVMYXRlc3RWZXJzaW9uKCkgewogIF9HRFJJVkVfUkVMRUFTRVNfSU5GTz0iJChjdXJsIC1zTCAiJEdJVEhVQl9BUElfQ1VSTF9BVVRIIiAiJF9HRVRfR0RSSVZFX0xBVEVTVF9WRVJTSU9OX1VSTCIgMj4mMSkiCiAgX0dEUklWRV9SRUxFQVNFU19JTkZPX01FU1NBR0U9IiQoZWNobyAiJF9HRFJJVkVfUkVMRUFTRVNfSU5GTyIgfCBqcSAtciAnLm1lc3NhZ2UnIDI+JjEpIgogIF9HRFJJVkVfUkVMRUFTRVNfSU5GT19NRVNTQUdFX0VYSVRfQ09ERT0kPwogIGlmIFsgJF9HRFJJVkVfUkVMRUFTRVNfSU5GT19NRVNTQUdFX0VYSVRfQ09ERSAtZXEgMCBdOyB0aGVuCiAgICBwcmludGYgIlxlWzkxbVx4RTJceDlDXHg5NVxlWzM5bVxuIiA+JjIKICAgIHByaW50ZiAiXG4lc1xuIiAiJF9NU0dfRVJST1JfUkVUUklFVklOR19HRFJJVkVfUkVMRUFTRVMiID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX1VSTCIgIiRfR0VUX0dEUklWRV9MQVRFU1RfVkVSU0lPTl9VUkwiID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX0VSUk9SIiAiJF9HRFJJVkVfUkVMRUFTRVNfSU5GT19NRVNTQUdFIiA+JjIKICAgIGV4aXQgJF9HRFJJVkVfUkVMRUFTRVNfSU5GT19NRVNTQUdFX0VYSVRfQ09ERQogIGZpOwogIF9QQVJTRV9HRFJJVkVfTEFTVEVTVF9WRVJTSU9OPSQoCiAgICBlY2hvICIkX0dEUklWRV9SRUxFQVNFU19JTkZPIiB8IFwKICAgIGpxIC1yICIuWyRfR0VUX0dEUklWRV9WRVJTSU9OX0lOREVYXS50YWdfbmFtZSIgMj4mMSkKICBfUEFSU0VfR0RSSVZFX0xBU1RFU1RfVkVSU0lPTl9FWElUX0NPREU9JD8KICBpZiBbICRfUEFSU0VfR0RSSVZFX0xBU1RFU1RfVkVSU0lPTl9FWElUX0NPREUgLW5lIDAgXTsgdGhlbgogICAgcHJpbnRmICJcZVs5MW1ceEUyXHg5Q1x4OTVcZVszOW1cbiIgPiYyCiAgICBwcmludGYgIlxuJXNcbiIgIiRfTVNHX0VSUk9SX1BBUlNJTkdfUEVOVUxUSU1BVEVfR0RSSVZFX1JFTEVBU0VTX1ZFUlNJT04iID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX1VSTCIgIiRfR0VUX0dEUklWRV9MQVRFU1RfVkVSU0lPTl9VUkwiID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX0VSUk9SX0NPREUiICIkX1BBUlNFX0dEUklWRV9MQVNURVNUX1ZFUlNJT05fRVhJVF9DT0RFIiA+JjIKICAgIHByaW50ZiAiJXM6ICVzIiAiJF9NU0dfRVJST1IiICIkX1BBUlNFX0dEUklWRV9MQVNURVNUX1ZFUlNJT04iID4mMgogICAgZXhpdCAkX1BBUlNFX0dEUklWRV9MQVNURVNUX1ZFUlNJT05fRVhJVF9DT0RFCiAgZmk7CiAgX0dEUklWRV9MQVNURVNUX1ZFUlNJT049JChlY2hvICIkX1BBUlNFX0dEUklWRV9MQVNURVNUX1ZFUlNJT04iIHwgY3V0IC1kJ3YnIC1mMiAyPiYxKQogIF9HRVRfR0RSSVZFX0xBVEVTVF9WRVJTSU9OX0VYSVRfQ09ERT0kPwogIGlmIFsgJF9HRVRfR0RSSVZFX0xBVEVTVF9WRVJTSU9OX0VYSVRfQ09ERSAtbmUgMCBdOyB0aGVuCiAgICAoKF9HRVRfR0RSSVZFX0xBVEVTVF9WRVJTSU9OX0FUVEVNUFRTKyspKQogICAgaWYgWyAkX0dFVF9HRFJJVkVfTEFURVNUX1ZFUlNJT05fQVRURU1QVFMgLWdlICRfR0VUX0dEUklWRV9MQVRFU1RfVkVSU0lPTl9NQVhfQVRURU1QVFMgXTsgdGhlbgogICAgICBwcmludGYgIlxlWzkxbVx4RTJceDlDXHg5NVxlWzM5bVxuIiA+JjIKICAgICAgcHJpbnQgIlxuJXNcbiIgIiRfTVNHX0VSUk9SX1JFVFJJRVZJTkdfTEFTVF9HRFJJVkVfUkVMRUFTRV9WRVJTSU9OIiA+JjIKICAgICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX1VSTCIgIiRfR0VUX0dEUklWRV9MQVRFU1RfVkVSU0lPTl9VUkwiID4mMgogICAgICBwcmludGYgIiVzOiAlZFxuIiAiJF9NU0dfRVJST1JfQ09ERSIgIiRfR0VUX0dEUklWRV9MQVRFU1RfVkVSU0lPTl9FWElUX0NPREUiID4mMgogICAgICBwcmludGYgIiVzOiAlcyIgIiRfTVNHX0VSUk9SIiAiJF9HRFJJVkVfTEFTVEVTVF9WRVJTSU9OIiA+JjIKICAgICAgZXhpdCAkX0dFVF9HRFJJVkVfTEFURVNUX1ZFUlNJT05fRVhJVF9DT0RFCiAgICBlbHNlCiAgICAgIGdldEdvb2dsZURyaXZlTGF0ZXN0VmVyc2lvbgogICAgZmk7CiAgZmk7CiAgY2hlY2tHb29nbGVEcml2ZVZlcnNpb25Ub0Rvd25sb2FkRXhpc3RzCiAgaWYgWyAkX0RPV05MT0FEX0dEUklWRV9VUkxfRVhJU1RTIC1uZSAxIF07IHRoZW4KICAgICgoX0dFVF9HRFJJVkVfVkVSU0lPTl80MDRfQVRURU1QVFMrKykpCiAgICAoKF9HRVRfR0RSSVZFX1ZFUlNJT05fSU5ERVgrKykpCiAgICBnZXRHb29nbGVEcml2ZUxhdGVzdFZlcnNpb24KICBlbHNlCiAgICBwcmludGYgIiAodiVzKSBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIgIiRfR0RSSVZFX0xBU1RFU1RfVkVSU0lPTiIKICBmaTsKfQpmdW5jdGlvbiBkb3dubG9hZEdvb2dsZURyaXZlKCkgewogIF9ET1dOTE9BRF9HRFJJVkVfVVJMPSJodHRwczovL2dpdGh1Yi5jb20vZ2RyaXZlLW9yZy9nZHJpdmUvcmVsZWFzZXMvZG93bmxvYWQvJF9HRFJJVkVfTEFTVEVTVF9WRVJTSU9OL2dkcml2ZS1saW51eC14NjQiCiAgX0RPV05MT0FEX0dEUklWRV9PVVRQVVQ9IiQoc3VkbyBjdXJsIC1zTCAiJF9ET1dOTE9BRF9HRFJJVkVfVVJMIiAtbyAiJDEiIDI+JjEpIgogIF9ET1dOTE9BRF9HRFJJVkVfRVhJVF9DT0RFPSQ/CiAgaWYgIFsgJF9ET1dOTE9BRF9HRFJJVkVfRVhJVF9DT0RFIC1uZSAwIF07IHRoZW4KICAgIHByaW50ZiAiXGVbOTFtXHhFMlx4OUNceDk1XGVbMzltXG4iID4mMgogICAgcHJpbnRmICJcbiVzICh2JXMpXG4iICIkX01TR19FUlJPUl9ET1dOTE9BRElOR19HRFJJVkUiICIkX0dEUklWRV9MQVNURVNUX1ZFUlNJT04iID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX1VSTCIgIiRfRE9XTkxPQURfR0RSSVZFX1VSTCIgPiYyCiAgICBwcmludGYgIiVzOiAlc1xuIiAiJF9NU0dfRVJST1IiICIkX0RPV05MT0FEX0dEUklWRV9PVVRQVVQiID4mMgogICAgZXhpdCAkX0RPV05MT0FEX0dEUklWRV9FWElUX0NPREUKICBmaTsKICBfR0RSSVZFX0JJTkFSWV9DT05URU5UPSIkKHN1ZG8gY2F0ICIkMSIgfCB0ciAtZCAnXDAnKSIKICBpZiBbICIkX0dEUklWRV9CSU5BUllfQ09OVEVOVCIgPSAiTm90IEZvdW5kIiBdOyB0aGVuCiAgICBpZiBbICRfR0VUX0dEUklWRV9WRVJTSU9OXzQwNF9BVFRFTVBUUyAtZ2UgJF9HRVRfR0RSSVZFX1ZFUlNJT05fNDA0X01BWF9BVFRFTVBUUyBdOyB0aGVuCiAgICAgIHN1ZG8gcm0gLWYgIiQxIgogICAgICBwcmludGYgIlxlWzkxbVx4RTJceDlDXHg5NVxlWzM5bVxuIiA+JjIKICAgICAgcHJpbnRmICJcbiVzICh2JXMpXG4iICIkX01TR19FUlJPUl9ET1dOTE9BRElOR19HRFJJVkUiICIkX0dEUklWRV9MQVNURVNUX1ZFUlNJT04iID4mMgogICAgICBwcmludGYgIiVzOiAlc1xuIiAiJF9NU0dfRVJST1JfRE9XTkxPQURJTkdfR0RSSVZFIiAiJF9ET1dOTE9BRF9HRFJJVkVfVVJMIiA+JjIKICAgICAgcHJpbnRmICIlczogNDA0XG4iICIkX01TR19FUlJPUl9DT0RFIiA+JjIKICAgICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX0VSUk9SIiAiJF9HRFJJVkVfQklOQVJZX0NPTlRFTlQiID4mMgogICAgICBleGl0IDEKICAgIGVsc2UKICAgICAgcHJpbnRmICIgKCVzKSBcZVs5MW1ceEUyXHg5Q1x4OTVcZVszOW1cbiIgIiRfTVNHX05PVF9GT1VORCIKICAgICAgKChfR0VUX0dEUklWRV9WRVJTSU9OXzQwNF9BVFRFTVBUUysrKSkKICAgICAgKChfR0VUX0dEUklWRV9WRVJTSU9OX0lOREVYKyspKQogICAgICBnZXRHb29nbGVEcml2ZUxhdGVzdFZlcnNpb24KICAgICAgZG93bmxvYWRHb29nbGVEcml2ZSAiJDEiCiAgICBmaTsKICBmaTsKICBzdWRvIGNobW9kICt4ICIkMSIKICBwcmludGYgIiBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIKfQpmdW5jdGlvbiBtYWluKCkgewogIHByaW50UHJlcGVuZGVkU3Rkb3V0CiAgcHJpbnRmICIlc1xuIiAiJF9NU0dfQ0hFQ0tJTkdfR0RSSVZFX0NMSUVOVCIKICBpbnN0YWxsU2NyaXB0RGVwZW5kZW5jaWVzCiAgcHJpbnRQcmVwZW5kZWRTdGRvdXQKICBwcmludGYgIiAgJXMiICIkX01TR19SRVRSSUVWSU5HX0xBU1RfQVZBSUxBQkxFX1ZFUlNJT04iCiAgZ2V0R29vZ2xlRHJpdmVMYXRlc3RWZXJzaW9uCiAgX0dEUklWRV9GSUxFUEFUSD0kKGNvbW1hbmQgLXYgZ2RyaXZlKQogIF9HRFJJVkVfRklMRVBBVEhfRVhJVF9DT0RFPSQ/CiAgaWYgWyAkX0dEUklWRV9GSUxFUEFUSF9FWElUX0NPREUgLW5lIDAgXTsgdGhlbgogICAgX0dEUklWRV9GSUxFUEFUSD0iIgogIGZpOwogIGlmIFsgIiRfR0RSSVZFX0ZJTEVQQVRIIiA9ICIiIF07IHRoZW4KICAgIHByaW50UHJlcGVuZGVkU3Rkb3V0CiAgICBwcmludGYgIiAgJXMgKHYlcykuLi4iICIkX01TR19ET1dOTE9BRElOR19HRFJJVkVfQ0xJRU5UIiAiJF9HRFJJVkVfTEFTVEVTVF9WRVJTSU9OIgogICAgZG93bmxvYWRHb29nbGVEcml2ZSAvdXNyL2Jpbi9nZHJpdmUKICBlbHNlCiAgICBfR0RSSVZFX1ZFUlNJT05fT1VUUFVUPSQoZ2RyaXZlIHZlcnNpb24gfCBoZWFkIC1uIDEgfCBjdXQgLWQnICcgLWYyKQogICAgX0dEUklWRV9WRVJTSU9OX09VVFBVVF9FWElUX0NPREU9JD8KICAgIGlmIFsgJF9HRFJJVkVfVkVSU0lPTl9PVVRQVVRfRVhJVF9DT0RFIC1uZSAwIF07IHRoZW4KICAgICAgc3VkbyBybSAtZiAiJChjb21tYW5kIC12IGdkcml2ZSkiCiAgICAgIHByaW50UHJlcGVuZGVkU3Rkb3V0CiAgICAgIHByaW50ZiAiICAlcyAodiVzKS4uLiIgIiRfTVNHX0RPV05MT0FESU5HX0dEUklWRV9DTElFTlQiICIkX0dEUklWRV9MQVNURVNUX1ZFUlNJT04iCiAgICAgIGRvd25sb2FkR29vZ2xlRHJpdmUgL3Vzci9iaW4vZ2RyaXZlCiAgICBlbHNlCiAgICAgIF9HRFJJVkVfSU5TVEFMTEVEX1ZFUlNJT049JF9HRFJJVkVfVkVSU0lPTl9PVVRQVVQKICAgICAgcHJpbnRQcmVwZW5kZWRTdGRvdXQKICAgIAlwcmludGYgIiAgJXMgKHYlcykiICIkX01TR19GT1VORF9HRFJJVkVfSU5TVEFMTEVEIiAiJF9HRFJJVkVfSU5TVEFMTEVEX1ZFUlNJT04iCiAgICAgIHByaW50ZiAiIFxlWzkybVx4RTJceDlDXHg5NFxlWzM5bVxuIgogICAgICBpZiBbICIkX0dEUklWRV9JTlNUQUxMRURfVkVSU0lPTiIgIT0gIiRfR0RSSVZFX0xBU1RFU1RfVkVSU0lPTiIgXTsgdGhlbgogICAgICAgIHByaW50UHJlcGVuZGVkU3Rkb3V0CiAgICAgICAgcHJpbnRmICIgICVzICh2JXMiICIkX01TR19VUERBVElOR19HRFJJVkUiICIkX0dEUklWRV9JTlNUQUxMRURfVkVSU0lPTiIKICAgICAgICBwcmludGYgIiAtPiB2JXMpLi4uIiAiJF9HRFJJVkVfTEFTVEVTVF9WRVJTSU9OIgogICAgICAgIHN1ZG8gcm0gLWYgJF9HRFJJVkVfRklMRVBBVEgKICAgICAgICBkb3dubG9hZEdvb2dsZURyaXZlICRfR0RSSVZFX0ZJTEVQQVRICiAgICAgIGZpOwogICAgZmk7CiAgZmk7Cn0KbWFpbgo=' | base64 -d)
