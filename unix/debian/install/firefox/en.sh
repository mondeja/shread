#!/bin/bash
_SCRIPT_FILENAME="$(basename "$0")" source <(printf 'IyEvYmluL2Jhc2gKIyAtKi0gRU5DT0RJTkc6IFVURi04IC0qLQpfTVNHX0VYRUNVVEVEX0FTX1NVUEVSVVNFUj0iVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgZXhlY3V0ZWQgYXMgc3VwZXJ1c2VyLiIKX01TR19DSEVDS0lOR19NT1pJTExBX0VDT1NZU1RFTT0iQ2hlY2tpbmcgTW96aWxsYSBlY29zeXN0ZW0uLi4iCl9NU0dfRk9VTkRfTU9aSUxMQV9GSVJFRk9YX0lOU1RBTExFRD0iTW96aWxsYSBGaXJlZm94IGZvdW5kIGluc3RhbGxlZCBpbiB0aGUgc3lzdGVtIgpfTVNHX0lOU1RBTExJTkdfTU9aSUxMQV9GSVJFRk9YX1BBQ0tBR0VTPSJJbnN0YWxsaW5nIE1vemlsbGEgRmlyZWZveCBwYWNrYWdlcy4uLiIKX01TR19GT1VORF9DSEVDS09EUklWRVJfSU5TVEFMTEVEPSJHZWNrb2RyaXZlciBmb3VuZCBpbnN0YWxsZWQgaW4gdGhlIHN5c3RlbSIKX01TR19JTlNUQUxMSU5HX0dFQ0tPRFJJVkVSPSJJbnN0YWxsaW5nIGdlY2tvZHJpdmVyLi4uIgppZiBbWyAkKC91c3IvYmluL2lkIC11KSAtbmUgMCBdXTsgdGhlbgogIHByaW50ZiAiJXNcbiIgIiRfTVNHX0VYRUNVVEVEX0FTX1NVUEVSVVNFUiIgPiYyCiAgZXhpdCAxCmZpOwpJTkRFTlRfU1RSSU5HPSIiCmZvciBhcmcgaW4gIiRAIjsgZG8KICBjYXNlICRhcmcgaW4KICAgIC0taW5kZW50KQogICAgc2hpZnQKICAgIElOREVOVF9TVFJJTkc9JDEKICAgIHNoaWZ0CiAgICA7OwogIGVzYWMKZG9uZQpmdW5jdGlvbiBwcmludEluZGVudCgpIHsKICBwcmludGYgIiVzIiAiJElOREVOVF9TVFJJTkciCn0KaWYgWyAiJChjb21tYW5kIC12IHBhY21hbikiID0gIiIgXTsgdGhlbgogIGlmIFsgIiRfU0NSSVBUX0ZJTEVOQU1FIiA9ICJtYWluLnNoIiBdOyB0aGVuCiAgICBmaWxlcGF0aD0ic3JjL3VuaXgvXy9kb3dubG9hZC9wYWNhcHQvbWFpbi5zaCIKICAgIGJhc2ggIiRmaWxlcGF0aCIgPiAvZGV2L251bGwKICBlbHNlCiAgICB1cmw9Imh0dHBzOi8vbW9uZGVqYS5naXRodWIuaW8vc2hyZWFkL3VuaXgvXy9kb3dubG9hZC9wYWNhcHQvJF9TQ1JJUFRfRklMRU5BTUUiCiAgICBjdXJsIC1zTCAiJHVybCIgfCBzdWRvIGJhc2ggLSA+IC9kZXYvbnVsbAogIGZpOwpmaTsKaWYgWyAteiAiJFVOSVhfRElTVFJPIiBdOyB0aGVuCiAgaWYgW1sgIiQoc3VkbyBwYWNtYW4gLVFpIGN1cmwgMj4gL2Rldi9udWxsIHwgZ3JlcCBTdGF0dXMpIiAhPSAiU3RhdHVzOiBpbnN0YWxsIG9rIGluc3RhbGxlZCIgXV07IHRoZW4KICAgIHN1ZG8gcGFjbWFuIC1TIGN1cmwgPiAvZGV2L251bGwgfHwgZXhpdCAkPwogIGZpOwogIHNvdXJjZSA8KGN1cmwgLXNMIGh0dHBzOi8vbW9uZGVqYS5naXRodWIuaW8vc2hyZWFkL3VuaXgvXy91dGlsL2dldC1kaXN0cm8vZW4uc2gpCmZpOwpwcmludEluZGVudApwcmludGYgIiVzXG4iICIkX01TR19DSEVDS0lOR19NT1pJTExBX0VDT1NZU1RFTSIKcHJpbnRJbmRlbnQKaWYgY29tbWFuZCAtdiBmaXJlZm94ICY+IC9kZXYvbnVsbDsgdGhlbgogIF9NT1pJTExBX0ZJUkVGT1hfVkVSU0lPTj0kKAogICAgc3VkbyAtdSAiJFNVRE9fVVNFUiIgZmlyZWZveCAtLXZlcnNpb24gfCBjdXQgLWQnICcgLWYzKQogIHByaW50ZiAiICAlcyAodiVzKSIgIiRfTVNHX0ZPVU5EX01PWklMTEFfRklSRUZPWF9JTlNUQUxMRUQiICIkX01PWklMTEFfRklSRUZPWF9WRVJTSU9OIgogIHByaW50ZiAiIFxlWzkybVx4RTJceDlDXHg5NFxlWzM5bVxuIgplbHNlCiAgcHJpbnRmICIgICVzXG4iICIkX01TR19JTlNUQUxMSU5HX01PWklMTEFfRklSRUZPWF9QQUNLQUdFUyIKICBpZiBbICIkVU5JWF9ESVNUUk8iID0gImRlYmlhbiIgXTsgdGhlbgogICAgX0ZJUkVGT1hfTEFURVNUX1ZFUlNJT049JCgKICAgICAgc3VkbyBhcHQtY2FjaGUgcG9saWN5IGZpcmVmb3gtZXNyIHwgZ3JlcCAtUG8gJyhcZCtcLikrXGQrJyB8IGhlYWQgLW4gMSkKICBlbHNlCiAgICBfRklSRUZPWF9MQVRFU1RfVkVSU0lPTj0kKAogICAgICBzdWRvIGFwdC1jYWNoZSBwb2xpY3kgZmlyZWZveCB8IGdyZXAgLVBvICcoXGQrXC4pK1xkKycgfCBoZWFkIC1uIDEpCiAgZmk7CiAgcHJpbnRmICIgKHYlcykuLi4iICIkX0ZJUkVGT1hfTEFURVNUX1ZFUlNJT04iCiAgaWYgWyAiJFVOSVhfRElTVFJPIiA9ICJkZWJpYW4iIF07IHRoZW4KICAgIF9NT1pJTExBX0ZJUkVGT1hfUEFDS0FHRVM9KAogICAgICAiZmlyZWZveC1lc3IiCiAgICAgICJmaXJlZm94LWVzci1sMTBuLWVzLWVzIgogICAgKQogIGVsc2UKICAgIF9NT1pJTExBX0ZJUkVGT1hfUEFDS0FHRVM9KAogICAgICAiZmlyZWZveCIKICAgICkKICBmaTsKICBmb3IgUEFDS0FHRSBpbiAiJHtfTU9aSUxMQV9GSVJFRk9YX1BBQ0tBR0VTW0BdfSI7IGRvCiAgICBwcmludEluZGVudAogICAgcHJpbnRmICIgICAgJXMiICIkUEFDS0FHRSIKICAgIGlmIFtbICIkKHN1ZG8gcGFjbWFuIC1RaSAiJFBBQ0tBR0UiIDI+IC9kZXYvbnVsbCB8IGdyZXAgU3RhdHVzKSIgIT0gIlN0YXR1czogaW5zdGFsbCBvayBpbnN0YWxsZWQiIF1dOyB0aGVuCiAgICAgIHN1ZG8gcGFjbWFuIC1TICIkUEFDS0FHRSIgPiAvZGV2L251bGwgfHwgZXhpdCAkPwogICAgZmk7CiAgICBwcmludGYgIiBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIKICBkb25lCmZpOwpwcmludEluZGVudApfR0VDS09EUklWRVJfUEFUSD0iJChjb21tYW5kIC12IGdlY2tvZHJpdmVyKSIKaWYgWyAiJF9HRUNLT0RSSVZFUl9QQVRIIiAhPSAiIiBdOyB0aGVuCiAgcHJpbnRmICIgICVzIiAiJF9NU0dfRk9VTkRfQ0hFQ0tPRFJJVkVSX0lOU1RBTExFRCIKICBwcmludGYgIiAodiVzKSIgIiQoZ2Vja29kcml2ZXIgLS12ZXJzaW9uIHwgaGVhZCAtbjEgfCBjdXQgLWQnICcgLWYyKSIKZWxzZQogIHByaW50ZiAiICAlcyIgIiRfTVNHX0lOU1RBTExJTkdfR0VDS09EUklWRVIiCiAgc3VkbyBwYWNtYW4gLVMgZmlyZWZveC1nZWNrb2RyaXZlciA+IC9kZXYvbnVsbApmaTsKcHJpbnRmICIgXGVbOTJtXHhFMlx4OUNceDk0XGVbMzltXG4iCg==' | base64 -d)
