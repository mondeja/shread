#!/bin/bash
source <(printf 'IyEvYmluL2Jhc2gKIyAtKi0gRU5DT0RJTkc6IFVURi04IC0qLQpfTVNHX0VYRUNVVEVEX0FTX1NVUEVSVVNFUj0iVGhpcyBzY3JpcHQgbmVlZHMgdG8gYmUgZXhlY3V0ZWQgYXMgc3VwZXJ1c2VyLiIKX01TR19DSEVDS0lOR19QQU5ET0M9IkNoZWNraW5nIFBhbmRvYy4uLiIKX01TR19FUlJPUl9SRVRSSUVWSU5HX1BBTkRPQ19SRUxFQVNFUz0iQW4gZXJyb3IgaGFwcGVuIHJldHJpZXZpbmcgaW5mb3JtYXRpb24gZm9yIFBhbmRvYyByZWxlYXNlcyBmcm9tIEdpdGh1YiBBUEkuIgpfTVNHX1VSTD0iVVJMIgpfTVNHX0VSUk9SPSJFcnJvciIKX01TR19FUlJPUl9DT0RFPSJFcnJvciBjb2RlIgpfTVNHX1JFVFJJRVZJTkdfTEFTVEVTVF9BVkFJTEFCTEVfVkVSU0lPTj0iUmV0cmlldmluZyBsYXN0ZXN0IGF2YWlsYWJsZSBQYW5kb2MgdmVyc2lvbi4uLiIKX01TR19ET1dOTE9BRElOR19QQUNLQUdFPSJEb3dubG9hZGluZyBwYWNrYWdlLi4uIgpfTVNHX0VSUk9SX1JFVFJJRVZJTkdfTEFTVEVTVF9QQU5ET0NfVkVSU0lPTj0iQW4gZXJyb3IgaGFwcGVuIHJldHJpZXZpbmcgbGFzdGVzdCBQYW5kb2MgdmVyc2lvbi4iCl9NU0dfRVJST1JfRE9XTkxPQURJTkdfUEFORE9DPSJBbiBlcnJvciBoYXBwZW4gZG93bmxvYWRpbmcgUGFuZG9jIgpfTVNHX05PVF9GT1VORD0iTm90IGZvdW5kIgpfTVNHX0lOU1RBTExJTkc9Ikluc3RhbGxpbmcuLi4iCl9NU0dfUEFORE9DX0ZPVU5EX0lOU1RBTExFRD0iUGFuZG9jIGZvdW5kIGluc3RhbGxlZCBpbiB0aGUgc3lzdGVtIgpfTVNHX1VQREFUSU5HX1BBTkRPQz0iVXBkYXRpbmcgUGFuZG9jIgppZiBbWyAkKC91c3IvYmluL2lkIC11KSAtbmUgMCBdXTsgdGhlbgogIHByaW50ZiAiJXNcbiIgIiRfTVNHX0VYRUNVVEVEX0FTX1NVUEVSVVNFUiIgPiYyCiAgZXhpdCAxCmZpOwpfUFJFUEVORF9TVERPVVRfU1RSSU5HPSIiCkdJVEhVQl9BUElfQ1VSTF9BVVRIPSIiCmlmIFsgLW4gIiRHSVRIVUJfVVNFUk5BTUUiIF0gJiYgWyAtbiAiJEdJVEhVQl9UT0tFTiIgXTsgdGhlbgogIEdJVEhVQl9BUElfQ1VSTF9BVVRIPSIkR0lUSFVCX1VTRVJOQU1FOiRHSVRIVUJfVE9LRU4iCmZpOwpmb3IgYXJnIGluICIkQCIKZG8KICAgIGNhc2UgJGFyZyBpbgogICAgICAgIC0tcHJlcGVuZC1zdGRvdXQpCiAgICAgICAgc2hpZnQKICAgICAgICBfUFJFUEVORF9TVERPVVRfU1RSSU5HPSQxCiAgICAgICAgc2hpZnQKICAgICAgICA7OwogICAgZXNhYwpkb25lCmZ1bmN0aW9uIHByaW50UHJlcGVuZGVkU3Rkb3V0KCkgewogIHByaW50ZiAiJXMiICIkX1BSRVBFTkRfU1RET1VUX1NUUklORyIKfQpwcmludFByZXBlbmRlZFN0ZG91dApwcmludGYgIiVzXG4iICIkX01TR19DSEVDS0lOR19QQU5ET0MiCklOU1RBTExBVElPTl9ERVBFTkRFTkNJRVM9KAogICJjdXJsIgogICJqcSIKKQpmb3IgREVQIGluICIke0lOU1RBTExBVElPTl9ERVBFTkRFTkNJRVNbQF19IjsgZG8KICBpZiBbWyAiJChzdWRvIGRwa2cgLXMgIiRERVAiIDI+IC9kZXYvbnVsbCB8IGdyZXAgU3RhdHVzKSIgIT0gIlN0YXR1czogaW5zdGFsbCBvayBpbnN0YWxsZWQiIF1dOyB0aGVuCiAgICBzdWRvIGFwdC1nZXQgaW5zdGFsbCAteSAtcXFxICIkREVQIiA+IC9kZXYvbnVsbCB8fCBleGl0ICQ/CiAgZmk7CmRvbmUKX0dFVF9QQU5ET0NfVkVSU0lPTl9JTkRFWD0wCl9HRVRfUEFORE9DX1ZFUlNJT05fNDA0X0FUVEVNUFRTPTAKX0dFVF9QQU5ET0NfVkVSU0lPTl80MDRfTUFYX0FUVEVNUFRTPTEwCmZ1bmN0aW9uIGNoZWNrUGFuZG9jVmVyc2lvblRvRG93bmxvYWRFeGlzdHMoKSB7CiAgX0RPV05MT0FEX1BBTkRPQ19VUkw9Imh0dHBzOi8vZ2l0aHViLmNvbS9qZ20vcGFuZG9jL3JlbGVhc2VzL2Rvd25sb2FkLyRfUEFORE9DX0xBU1RFU1RfVkVSU0lPTi9wYW5kb2MtJF9QQU5ET0NfTEFTVEVTVF9WRVJTSU9OLTEtYW1kNjQuZGViIgogIF9ET1dOTE9BRF9QQU5ET0NfVVJMX0VYSVNUUz0wCiAgaWYgY3VybCAtLW91dHB1dCAvZGV2L251bGwgLS1zaWxlbnQgLS1oZWFkIC0tZmFpbCAiJF9ET1dOTE9BRF9QQU5ET0NfVVJMIjsgdGhlbgogICAgX0RPV05MT0FEX1BBTkRPQ19VUkxfRVhJU1RTPTEKICBmaTsKfQpfR0VUX1BBTkRPQ19MQVRFU1RfVkVSU0lPTl9BVFRFTVBUUz0wCl9HRVRfUEFORE9DX0xBVEVTVF9WRVJTSU9OX01BWF9BVFRFTVBUUz01Cl9HRVRfUEFORE9DX0xBVEVTVF9WRVJTSU9OX1VSTD0iaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9qZ20vcGFuZG9jL3JlbGVhc2VzIgpmdW5jdGlvbiBnZXRQYW5kb2NMYXRlc3RWZXJzaW9uKCkgewogIF9QQU5ET0NfUkVMRUFTRVNfSU5GTz0iJChjdXJsIC1zTCAiJEdJVEhVQl9BUElfQ1VSTF9BVVRIIiAiJF9HRVRfUEFORE9DX0xBVEVTVF9WRVJTSU9OX1VSTCIgMj4mMSkiCiAgX1BBTkRPQ19SRUxFQVNFU19JTkZPX01FU1NBR0U9IiQoZWNobyAiJF9QQU5ET0NfUkVMRUFTRVNfSU5GTyIgfCBqcSAtciAnLm1lc3NhZ2UnIDI+JjEpIgogIF9QQU5ET0NfUkVMRUFTRVNfSU5GT19NRVNTQUdFX0VYSVRfQ09ERT0kPwogIGlmIFsgJF9QQU5ET0NfUkVMRUFTRVNfSU5GT19NRVNTQUdFX0VYSVRfQ09ERSAtZXEgMCBdOyB0aGVuCiAgICBwcmludGYgIlxlWzkxbVx4RTJceDlDXHg5NVxlWzM5bVxuIiA+JjIKICAgIHByaW50ZiAiXG4lc1xuIiAiJF9NU0dfRVJST1JfUkVUUklFVklOR19QQU5ET0NfUkVMRUFTRVMiID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX1VSTCIgIiRfR0VUX1BBTkRPQ19MQVRFU1RfVkVSU0lPTl9VUkwiID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX0VSUk9SIiAiJF9QQU5ET0NfUkVMRUFTRVNfSU5GT19NRVNTQUdFIiA+JjIKICAgIGV4aXQgJF9QQU5ET0NfUkVMRUFTRVNfSU5GT19NRVNTQUdFX0VYSVRfQ09ERQogIGZpOwogIF9QQU5ET0NfTEFTVEVTVF9WRVJTSU9OPSQoCiAgICBlY2hvICIkX1BBTkRPQ19SRUxFQVNFU19JTkZPIiB8IFwKICAgIGpxIC1yICIuWyRfR0VUX1BBTkRPQ19WRVJTSU9OX0lOREVYXS50YWdfbmFtZSIgMj4mMQogICkKICBfR0VUX1BBTkRPQ19MQVRFU1RfVkVSU0lPTl9FWElUX0NPREU9JD8KICBpZiBbICRfR0VUX1BBTkRPQ19MQVRFU1RfVkVSU0lPTl9FWElUX0NPREUgLW5lIDAgXTsgdGhlbgogICAgKCggX0dFVF9QQU5ET0NfTEFURVNUX1ZFUlNJT05fQVRURU1QVFMrKyApKQogICAgaWYgWyAkX0dFVF9QQU5ET0NfTEFURVNUX1ZFUlNJT05fQVRURU1QVFMgLWdlICRfR0VUX1BBTkRPQ19MQVRFU1RfVkVSU0lPTl9NQVhfQVRURU1QVFMgXTsgdGhlbgogICAgICBwcmludGYgIlxlWzkxbVx4RTJceDlDXHg5NVxlWzM5bVxuIiA+JjIKICAgICAgcHJpbnQgIlxuJXNcbiIgIiRfTVNHX0VSUk9SX1JFVFJJRVZJTkdfTEFTVEVTVF9QQU5ET0NfVkVSU0lPTiIgPiYyCiAgICAgIHByaW50ZiAiJXM6ICVzXG4iICIkX01TR19VUkwiICIkX0dFVF9QQU5ET0NfTEFURVNUX1ZFUlNJT05fVVJMIiA+JjIKICAgICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX0VSUk9SX0NPREUiICIkX0dFVF9QQU5ET0NfTEFURVNUX1ZFUlNJT05fRVhJVF9DT0RFIiA+JjIKICAgICAgcHJpbnRmICIlczogJXMiICIkX01TR19FUlJPUiIgIiRfUEFORE9DX0xBU1RFU1RfVkVSU0lPTiIgPiYyCiAgICAgIGV4aXQgJF9HRVRfUEFORE9DX0xBVEVTVF9WRVJTSU9OX0VYSVRfQ09ERQogICAgZWxzZQogICAgICBnZXRQYW5kb2NMYXRlc3RWZXJzaW9uCiAgICBmaTsKICBmaTsKICBjaGVja1BhbmRvY1ZlcnNpb25Ub0Rvd25sb2FkRXhpc3RzCiAgaWYgWyAkX0RPV05MT0FEX1BBTkRPQ19VUkxfRVhJU1RTIC1uZSAxIF07IHRoZW4KICAgICgoIF9HRVRfUEFORE9DX1ZFUlNJT05fNDA0X0FUVEVNUFRTKysgKSkKICAgICgoIF9HRVRfUEFORE9DX1ZFUlNJT05fSU5ERVgrKyApKQogICAgZ2V0UGFuZG9jTGF0ZXN0VmVyc2lvbgogIGVsc2UKICAgIHByaW50ZiAiICh2JXMpIFxlWzkybVx4RTJceDlDXHg5NFxlWzM5bVxuIiAiJF9QQU5ET0NfTEFTVEVTVF9WRVJTSU9OIgogIGZpOwp9CnByaW50UHJlcGVuZGVkU3Rkb3V0CnByaW50ZiAiICAlcyIgIiRfTVNHX1JFVFJJRVZJTkdfTEFTVEVTVF9BVkFJTEFCTEVfVkVSU0lPTiIKZ2V0UGFuZG9jTGF0ZXN0VmVyc2lvbgpfUEFORE9DX0ZJTEVQQVRIPSIkKGNvbW1hbmQgLXYgcGFuZG9jKSIKX1BBTkRPQ19GSUxFUEFUSF9FWElUX0NPREU9JD8KaWYgWyAkX1BBTkRPQ19GSUxFUEFUSF9FWElUX0NPREUgLW5lIDAgXTsgdGhlbgogIF9QQU5ET0NfRklMRVBBVEg9IiIKZmk7CmZ1bmN0aW9uIGRvd25sb2FkUGFuZG9jKCkgewogIHByaW50UHJlcGVuZGVkU3Rkb3V0CiAgcHJpbnRmICIgICVzIiAiJF9NU0dfRE9XTkxPQURJTkdfUEFDS0FHRSIKICBfRE9XTkxPQURfUEFORE9DX1VSTD0iaHR0cHM6Ly9naXRodWIuY29tL2pnbS9wYW5kb2MvcmVsZWFzZXMvZG93bmxvYWQvJF9QQU5ET0NfTEFTVEVTVF9WRVJTSU9OL3BhbmRvYy0kX1BBTkRPQ19MQVNURVNUX1ZFUlNJT04tMS1hbWQ2NC5kZWIiCiAgX0RPV05MT0FEX1BBTkRPQ19PVVRQVVQ9IiQoc3VkbyBjdXJsIC1zTCAiJF9ET1dOTE9BRF9QQU5ET0NfVVJMIiAtbyAiJDEiIDI+JjEpIgogIF9ET1dOTE9BRF9QQU5ET0NfRVhJVF9DT0RFPSQ/CiAgaWYgIFsgJF9ET1dOTE9BRF9QQU5ET0NfRVhJVF9DT0RFIC1uZSAwIF07IHRoZW4KICAgIHByaW50ZiAiXGVbOTFtXHhFMlx4OUNceDk1XGVbMzltXG4iID4mMgogICAgcHJpbnRmICJcbiVzICh2JXMpXG4iICIkX01TR19FUlJPUl9ET1dOTE9BRElOR19QQU5ET0MiICIkX1BBTkRPQ19MQVNURVNUX1ZFUlNJT04iID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX1VSTCIgIiRfRE9XTkxPQURfUEFORE9DX1VSTCIgPiYyCiAgICBwcmludGYgIiVzOiAlc1xuIiAiJF9NU0dfRVJST1IiICIkX0RPV05MT0FEX1BBTkRPQ19PVVRQVVQiID4mMgogICAgZXhpdCAkX0RPV05MT0FEX1BBTkRPQ19FWElUX0NPREUKICBmaTsKICBfUEFORE9DX0JJTkFSWV9DT05URU5UPSIkKHN1ZG8gY2F0ICIkMSIgfCB0ciAtZCAnXDAnKSIKICBpZiBbICIkX1BBTkRPQ19CSU5BUllfQ09OVEVOVCIgPSAiTm90IEZvdW5kIiBdOyB0aGVuCiAgICBpZiBbICRfR0VUX1BBTkRPQ19WRVJTSU9OXzQwNF9BVFRFTVBUUyAtZ2UgJF9HRVRfUEFORE9DX1ZFUlNJT05fNDA0X01BWF9BVFRFTVBUUyBdOyB0aGVuCiAgICAgIHN1ZG8gcm0gLWYgIiQxIgogICAgICBwcmludGYgIlxlWzkxbVx4RTJceDlDXHg5NVxlWzM5bVxuIiA+JjIKICAgICAgcHJpbnRmICJcbiVzICh2JXMpXG4iICIkX01TR19FUlJPUl9ET1dOTE9BRElOR19QQU5ET0MiICIkX1BBTkRPQ19MQVNURVNUX1ZFUlNJT04iID4mMgogICAgICBwcmludGYgIiVzOiAlc1xuIiAiJF9NU0dfVVJMIiAiJF9ET1dOTE9BRF9QQU5ET0NfVVJMIiA+JjIKICAgICAgcHJpbnRmICIlczogNDA0XG4iICIkX01TR19FUlJPUl9DT0RFIiA+JjIKICAgICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX0VSUk9SIiAiJF9QQU5ET0NfQklOQVJZX0NPTlRFTlQiID4mMgogICAgICBleGl0IDEKICAgIGVsc2UKICAgICAgcHJpbnRmICIgKCVzKSBcZVs5MW1ceEUyXHg5Q1x4OTVcZVszOW1cbiIgIiRfTVNHX05PVF9GT1VORCIKICAgICAgKCggX0dFVF9QQU5ET0NfVkVSU0lPTl80MDRfQVRURU1QVFMrKyApKQogICAgICAoKCBfR0VUX1BBTkRPQ19WRVJTSU9OX0lOREVYKysgKSkKICAgICAgZ2V0UGFuZG9jTGF0ZXN0VmVyc2lvbgogICAgICBkb3dubG9hZFBhbmRvYyAiJDEiCiAgICBmaTsKICBmaTsKICBzdWRvIGNobW9kICt4ICIkMSIKICBwcmludGYgIiBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIKfQpmdW5jdGlvbiBpbnN0YWxsUGFuZG9jKCkgewogIHByaW50UHJlcGVuZGVkU3Rkb3V0CiAgcHJpbnRmICIgICVzIiAiJF9NU0dfSU5TVEFMTElORyIKICBzdWRvIGRwa2cgLWkgIiQxIiA+IC9kZXYvbnVsbCB8fCBleGl0ICQ/CiAgcHJpbnRmICIgXGVbOTJtXHhFMlx4OUNceDk0XGVbMzltXG4iCiAgcm0gLWYgIiQxIgp9CmlmIFsgIiRfUEFORE9DX0ZJTEVQQVRIIiA9ICIiIF07IHRoZW4KICBkb3dubG9hZFBhbmRvYyB+L3BhbmRvYy5kZWIKICBpbnN0YWxsUGFuZG9jIH4vcGFuZG9jLmRlYgplbHNlCiAgX1BBTkRPQ19WRVJTSU9OX09VVFBVVD0iJChwYW5kb2MgLS12ZXJzaW9uIHwgaGVhZCAtbiAxIHwgY3V0IC1kJyAnIC1mMikiCiAgX1BBTkRPQ19WRVJTSU9OX09VVFBVVF9FWElUX0NPREU9JD8KICBpZiBbICRfUEFORE9DX1ZFUlNJT05fT1VUUFVUX0VYSVRfQ09ERSAtbmUgMCBdOyB0aGVuCiAgICBzdWRvIHJtIC1mICIkKGNvbW1hbmQgLXYgcGFuZG9jKSIKICAgIGRvd25sb2FkUGFuZG9jIH4vcGFuZG9jLmRlYgogICAgaW5zdGFsbFBhbmRvYyB+L3BhbmRvYy5kZWIKICBlbHNlCiAgICBwcmludFByZXBlbmRlZFN0ZG91dAogIAlwcmludGYgIiAgJXMgKHYlcykiICIkX01TR19QQU5ET0NfRk9VTkRfSU5TVEFMTEVEIiAiJF9QQU5ET0NfVkVSU0lPTl9PVVRQVVQiCiAgICBpZiBbICIkX1BBTkRPQ19WRVJTSU9OX09VVFBVVCIgIT0gIiRfUEFORE9DX0xBU1RFU1RfVkVSU0lPTiIgXTsgdGhlbgogICAgICBwcmludGYgIiBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIKICAgICAgcHJpbnRQcmVwZW5kZWRTdGRvdXQKICAgICAgcHJpbnRmICIgICVzICh2JXMiICIkX01TR19VUERBVElOR19QQU5ET0MiICIkX1BBTkRPQ19WRVJTSU9OX09VVFBVVCIKICAgICAgcHJpbnRmICIgLT4gdiVzKS4uLlxuIiAiJF9QQU5ET0NfTEFTVEVTVF9WRVJTSU9OIgogICAgICBfUFJFUEVORF9TVERPVVRfU1RSSU5HPSIgICRfUFJFUEVORF9TVERPVVRfU1RSSU5HIgogICAgICBzdWRvIHJtIC1mICRfUEFORE9DX0ZJTEVQQVRICiAgICAgIGRvd25sb2FkUGFuZG9jIH4vcGFuZG9jLmRlYgogICAgICBpbnN0YWxsUGFuZG9jIH4vcGFuZG9jLmRlYgogICAgZWxzZQogICAgICBwcmludGYgIiBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIKICAgIGZpOwogIGZpOwpmaTsK' | base64 -d)
