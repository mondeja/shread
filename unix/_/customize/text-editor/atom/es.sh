#!/bin/bash
_SCRIPT_FILENAME="$(basename "$0")" source <(printf 'IyEvYmluL2Jhc2gKIyAtKi0gRU5DT0RJTkc6IFVURi04IC0qLQpfTVNHX0VYRUNVVEVEX0FTX1NVUEVSVVNFUj0iRXN0ZSBzY3JpcHQgbmVjZXNpdGEgc2VyIGVqZWN1dGFkbyBjb21vIHN1cGVydXN1YXJpby4iCl9NU0dfQVRPTV9OT1RfSU5TVEFMTEVEX0ZPUl9MT0NBTF9VU0VSPSJBdG9tIG5vIGVzdMOhIGluc3RhbGFkbyBwYXJhIGVsIHVzdWFyaW8gbG9jYWwiCl9NU0dfRElSRUNUT1JZX0RPRVNOVF9FWElTVFM9IkVsIGRpcmVjdG9yaW8gJyRIT01FLy5hdG9tJyBubyBleGlzdGUuIgpfTVNHX05PREVKU19NVVNUX0JFX0lOU1RBTExFRD0iTm9kZUpTIG5lY2VzaXRhIGVzdGFyIGluc3RhbGFkbyBhbnRlcyBkZSBwZXJzb25hbGl6YXIgQXRvbS4iCl9NU0dfQ1VTVE9NSVpJTkdfQVRPTT0iUGVyc29uYWxpemFuZG8gZWwgZWRpdG9yIGRlIHRleHRvcyBBdG9tIgpfTVNHX0NIRUNLSU5HX0lOU1RBTExFRF9BVE9NX1BBQ0tBR0VTPSJDb21wcm9iYW5kbyBwYXF1ZXRlcyBkZSBBdG9tIGluc3RhbGFkb3MuLi4iCl9NU0dfQ09ORklHVVJJTkdfRURJVE9SPSJDb25maWd1cmFuZG8gZWwgZWRpdG9yLi4uIgpfTVNHX0RJU0FCTElOR19JTkNPTVBBVElCTEVfUEFDS0FHRVM9IkRlc2hhYmlsaXRhbmRvIHBhcXVldGVzIGluY29tcGF0aWJsZXMuLi4iCl9NU0dfRVJST1JfSU5TVEFMTElOR19BVE9NX1BBQ0tBR0U9Ik9jdXJyacOzIHVuIGVycm9yIGluc3RhbGFuZG8gcGFxdWV0ZSBkZSBBdG9tIgpfTVNHX0VSUk9SX0RJU0FCTElOR19BVE9NX1BBQ0tBR0U9Ik9jdXJyacOzIHVuIGVycm9yIGRlc2hhYmlsaXRhbmRvIGVsIHBhcXVldGUgZGUgQXRvbSIKaWYgW1sgJCgvdXNyL2Jpbi9pZCAtdSkgLW5lIDAgXV07IHRoZW4KICBwcmludGYgIiVzXG4iICIkX01TR19FWEVDVVRFRF9BU19TVVBFUlVTRVIiID4mMgogIGV4aXQgMQpmaTsKaWYgWyAhIC1kIH4vLmF0b20gXTsgdGhlbgogIHByaW50ZiAiJXMgKCRVU0VSKS5cbiIgIiRfTVNHX0FUT01fTk9UX0lOU1RBTExFRF9GT1JfTE9DQUxfVVNFUiIKICBwcmludGYgIiVzXG4iICIkX01TR19ESVJFQ1RPUllfRE9FU05UX0VYSVNUUyIKICBleGl0IDEKZmk7CmlmIFsgIiQoY29tbWFuZCAtdiBub2RlKSIgPSAiIiBdOyB0aGVuCiAgcHJpbnRmICIlc1xuIiAiJF9NU0dfTk9ERUpTX01VU1RfQkVfSU5TVEFMTEVEIiA+JjIKICBleGl0IDEKZmk7CklOREVOVF9TVFJJTkc9IiIKZm9yIGFyZyBpbiAiJEAiOyBkbwogIGNhc2UgJGFyZyBpbgogICAgLS1pbmRlbnQpCiAgICBzaGlmdAogICAgSU5ERU5UX1NUUklORz0kMQogICAgc2hpZnQKICAgIDs7CiAgZXNhYwpkb25lCmZ1bmN0aW9uIHByaW50SW5kZW50KCkgewogIHByaW50ZiAiJXMiICIkSU5ERU5UX1NUUklORyIKfQppZiBbICIkKGNvbW1hbmQgLXYgcGFjbWFuKSIgPSAiIiBdOyB0aGVuCiAgaWYgWyAiJF9TQ1JJUFRfRklMRU5BTUUiID0gIm1haW4uc2giIF07IHRoZW4KICAgIGZpbGVwYXRoPSJzcmMvdW5peC9fL2Rvd25sb2FkL3BhY2FwdC9tYWluLnNoIgogICAgYmFzaCAiJGZpbGVwYXRoIiA+IC9kZXYvbnVsbAogIGVsc2UKICAgIHVybD0iaHR0cHM6Ly9tb25kZWphLmdpdGh1Yi5pby9zaHJlYWQvdW5peC9fL2Rvd25sb2FkL3BhY2FwdC8kX1NDUklQVF9GSUxFTkFNRSIKICAgIGN1cmwgLXNMICIkdXJsIiB8IHN1ZG8gYmFzaCAtID4gL2Rldi9udWxsCiAgZmk7CmZpOwppZiBbWyAiJChzdWRvIHBhY21hbiAtUWkgY3VybCAyPiAvZGV2L251bGwgfCBncmVwIFN0YXR1cykiICE9ICJTdGF0dXM6IGluc3RhbGwgb2sgaW5zdGFsbGVkIiBdXTsgdGhlbgogIHN1ZG8gcGFjbWFuIC1TIGN1cmwgPiAvZGV2L251bGwgfHwgZXhpdCAkPwpmaTsKQVRPTV9WRVJTSU9OPSQoCiAgYXBtIC12IHwgXAogIHNlZCAtbiA0cCB8IFwKICBjdXQgLWQnICcgLWYyIHwgXAogIHNlZCAtciAicy9ceDFCXFsoWzAtOV17MSwyfSg7WzAtOV17MSwyfSk/KT9bbUdLXS8vZyIpCnByaW50SW5kZW50CnByaW50ZiAiJXMgKHYlcykuLi5cbiIgIiRfTVNHX0NVU1RPTUlaSU5HX0FUT00iICIkQVRPTV9WRVJTSU9OIgpwcmludEluZGVudApwcmludGYgIiAgJXNcbiIgIiRfTVNHX0NIRUNLSU5HX0lOU1RBTExFRF9BVE9NX1BBQ0tBR0VTIgpfQVRPTV9QQUNLQUdFU19JTlNUQUxMRUQ9IiQoYXBtIGxpc3QgLS1pbnN0YWxsZWQgLS1iYXJlKSIKX0FUT01fUEFDS0FHRVNfVE9fSU5TVEFMTD0oCiAgIi0tcHJvZHVjdGlvbiBmaWxlLWljb25zIgogICJsYW5ndWFnZS1iYXRjaGZpbGUiCiAgInBpZ21lbnRzIgogICJjb2xvci1waWNrZXIiCiAgImF0b20tYmVhdXRpZnkiCiAgInplbnRhYnMiCiAgImVkaXRvcmNvbmZpZyIKICAibWluaW1hcCIKICAiaGlnaGxpZ2h0LXNlbGVjdGVkIgogICJnb3RvLWRlZmluaXRpb24iCiAgImF1dG9jb21wbGV0ZS1wYXRocyIKICAibGludGVyIgogICJsaW50ZXItdWktZGVmYXVsdCIKICAiaW50ZW50aW9ucyIKICAiYnVzeS1zaWduYWwiCiAgImxpbnRlci1jc3NsaW50IgogICJsaW50ZXItanNvbmxpbnQiCiAgImxpbnRlci1zd2FnZ2VyIgogICJsaW50ZXIteG1sbGludCIKICAibWluaW1hcC1saW50ZXIiCiAgImxhbmd1YWdlLXZ1ZSIKKQpmb3IgUEFDS0FHRSBpbiAiJHtfQVRPTV9QQUNLQUdFU19UT19JTlNUQUxMW0BdfSI7IGRvCiAgX1BBQ0tBR0VfRkxBR1M9IiQocHJpbnRmICIlcyIgIiRQQUNLQUdFIiB8IGN1dCAtZCcgJyAtZjEpIgogIGlmIFsgIiRfUEFDS0FHRV9GTEFHUyIgIT0gIiIgXTsgdGhlbgogICAgUEFDS0FHRT0kKHByaW50ZiAiJXMiICIkUEFDS0FHRSIgfCBjdXQgLWQnICcgLWYyKQogIGZpOwogIHByaW50SW5kZW50CiAgcHJpbnRmICIgICAgJXMiICIkUEFDS0FHRSIKICBpZiBbWyAiJChwcmludGYgIiVzIiAiJF9BVE9NX1BBQ0tBR0VTX0lOU1RBTExFRCIgfCBncmVwICIkUEFDS0FHRSIpIiA9ICIiIF1dOyB0aGVuCiAgICBfQU1QX0lOU1RBTExfU1RERVJSPSIkKGFwbSBpbnN0YWxsICIkX1BBQ0tBR0VfRkxBR1MgJFBBQ0tBR0UiIDI+JjEgPiAvZGV2L251bGwpIgogICAgX0FNUF9JTlNUQUxMX0VYSVRfQ09ERT0kPwogICAgaWYgWyAkX0FNUF9JTlNUQUxMX0VYSVRfQ09ERSAtbmUgMCBdOyB0aGVuCiAgICAgIHByaW50ZiAiIFxlWzkxbVx4RTJceDlDXHg5NVxlWzM5bVxuIiA+JjIKICAgICAgcHJpbnRmICJcbiVzICclcyc6XG4iICIkX01TR19FUlJPUl9JTlNUQUxMSU5HX0FUT01fUEFDS0FHRSIgIiRQQUNLQUdFIiA+JjIKICAgICAgcHJpbnRmICIlc1xuIiAiJF9BTVBfSU5TVEFMTF9TVERFUlIiID4mMgogICAgICBleGl0ICRfQU1QX0lOU1RBTExfRVhJVF9DT0RFCiAgICBmaTsKICBmaTsKICBwcmludGYgIiBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIKZG9uZQp5YXJuIGluc3RhbGwgLS1zaWxlbnQgLS1uby1wcm9ncmVzcyAtLWlnbm9yZS1vcHRpb25hbCAtLW5vbi1pbnRlcmFjdGl2ZQpwcmludEluZGVudApwcmludGYgIiAgJXMiICIkX01TR19DT05GSUdVUklOR19FRElUT1IiCmN1cmwgLXNMIGh0dHBzOi8vbW9uZGVqYS5naXRodWIuaW8vc2hyZWFkL18vY3VzdG9taXplL3RleHQtZWRpdG9yL2F0b20vY29uZmlndXJlLmpzIHwgXAogIG5vZGUgLSBcCiAgZXhpdCAkPwpwcmludGYgIiBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIKcHJpbnRJbmRlbnQKcHJpbnRmICIgICVzXG4iICIkX01TR19ESVNBQkxJTkdfSU5DT01QQVRJQkxFX1BBQ0tBR0VTIgpfQVRPTV9QQUNLQUdFU19UT19ESVNBQkxFPSgKICAid2hpdGVzcGFjZSIKKQpmb3IgUEFDS0FHRSBpbiAiJHtfQVRPTV9QQUNLQUdFU19UT19ESVNBQkxFW0BdfSI7IGRvCiAgcHJpbnRJbmRlbnQKICBwcmludGYgIiAgICAlcyIgIiRQQUNLQUdFIgogIF9BTVBfRElTQUJMRV9TVERFUlI9IiQoc3VkbyAtdSAiJFNVRE9fVVNFUiIgYXBtIGRpc2FibGUgIiRQQUNLQUdFIiAyPiYxID4gL2Rldi9udWxsKSIKICBfQU1QX0RJU0FCTEVfRVhJVF9DT0RFPSQ/CiAgaWYgWyAkX0FNUF9ESVNBQkxFX0VYSVRfQ09ERSAtbmUgMCBdOyB0aGVuCiAgICBwcmludGYgIiBcZVs5MW1ceEUyXHg5Q1x4OTVcZVszOW1cbiIgPiYyCiAgICBwcmludGYgIlxuJXMgJyVzJzpcbiIgIiRfTVNHX0VSUk9SX0RJU0FCTElOR19BVE9NX1BBQ0tBR0UiICIkUEFDS0FHRSIgPiYyCiAgICBwcmludGYgIiVzXG4iICIkX0FNUF9ESVNBQkxFX1NUREVSUiIgPiYyCiAgICBleGl0ICRfQU1QX0RJU0FCTEVfRVhJVF9DT0RFCiAgZmk7CiAgcHJpbnRmICIgXGVbOTJtXHhFMlx4OUNceDk0XGVbMzltXG4iCmRvbmUK' | base64 -d)
