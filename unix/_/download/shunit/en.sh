#!/bin/bash
source <(printf 'IyEvYmluL2Jhc2gKIyAtKi0gRU5DT0RJTkc6IFVURi04IC0qLQpfTVNHX1VSTD0iVVJMIgpfTVNHX0VSUk9SPSJFcnJvciIKX01TR19FUlJPUl9DT0RFPSJFcnJvciBjb2RlIgpfTVNHX0VSUk9SX1JFVFJJRVZJTkdfU0hVTklUX1JFTEVBU0VTX0lORk89IkFuIGVycm9yIGhhcHBlbiByZXRyaWV2aW5nIHNodW5pdDIgcmVsZWFzZXMgaW5mb3JtYXRpb24gZnJvbSBHaXRodWIgQVBJLiIKX01TR19DSEVDS0lOR19TSFVOSVQ9IkNoZWNraW5nIHNodW5pdDIuLi4iCl9NU0dfUkVUUklFVklOR19TSFVOSVRfTEFTVEVTVF9WRVJTSU9OPSJSZXRyaWV2aW5nIGxhc3Rlc3QgdmVyc2lvbi4uLiIKX01TR19FUlJPUl9QQVJTSU5HX0xBU1RFU1RfU0hVTklUX1JFTEVBU0U9IkFuIGVycm9yIGhhcHBlbiBwYXJzaW5nIGxhc3Rlc3Qgc2h1bml0MiByZWxlYXNlIHZlcnNpb24gZnJvbSBHaXRodWIgQVBJLiIKX01TR19ET1dOTE9BRElOR19TSFVOSVQ9IkRvd25sb2FkaW5nIHNodW5pdDIiCl9NU0dfRVJST1JfRE9XTkxPQURJTkdfU0hVTklUPSJBbiBlcnJvciBoYXBwZW4gZG93bmxvYWRpbmcgc2h1bml0MiIKX01TR19VTlpJUFBJTkdfU0hVTklUPSJVbnppcHBpbmcuLi4iCl9NU0dfREVTVF9FWElTVFM9IkRlc3RpbmF0aW9uIGZpbGUgZXhpc3RzIgpfTVNHX0lORElDQVRFX0FOT1RIRVJfREVTVF9XSVRIX1BBUkFNPSJJbmRpY2F0ZSBhbm90aGVyIGRlc3RpbmF0aW9uIGZvciBzaHVuaXQyIHdpdGggcGFyYW1ldGVyIgpJTkRFTlRfU1RSSU5HPSIiCl9ERVNUX1BBVEg9IiRQV0Qvc2h1bml0MiIKR0lUSFVCX0FQSV9DVVJMX0FVVEg9IiIKaWYgWyAtbiAiJEdJVEhVQl9VU0VSTkFNRSIgXSAmJiBbIC1uICIkR0lUSFVCX1RPS0VOIiBdOyB0aGVuCiAgR0lUSFVCX0FQSV9DVVJMX0FVVEg9IiRHSVRIVUJfVVNFUk5BTUU6JEdJVEhVQl9UT0tFTiIKZmk7CmZvciBhcmcgaW4gIiRAIjsgZG8KICBjYXNlICRhcmcgaW4KICAgIC0taW5kZW50KQogICAgc2hpZnQKICAgIElOREVOVF9TVFJJTkc9JDEKICAgIHNoaWZ0CiAgICA7OwogICAgLS1kZXN0LXBhdGgpCiAgICBzaGlmdAogICAgX0RFU1RfUEFUSD0kMQogICAgc2hpZnQKICAgIDs7CiAgZXNhYwpkb25lCl9ERVNUX0RJUlBBVEg9IiQoZGlybmFtZSAiJF9ERVNUX1BBVEgiKSIKZnVuY3Rpb24gcHJpbnRQcmVwZW5kZWRTdGRvdXQoKSB7CiAgcHJpbnRmICIlcyIgIiRJTkRFTlRfU1RSSU5HIgp9CmlmIFsgIiQoY29tbWFuZCAtdiBwYWNtYW4pIiA9ICIiIF07IHRoZW4KICBTQ1JJUFRfRklMRU5BTUU9IiQoYmFzZW5hbWUgIiQwIikiCiAgaWYgWyAiJFNDUklQVF9GSUxFTkFNRSIgPSAibWFpbi5zaCIgXTsgdGhlbgogICAgZmlsZXBhdGg9InNyYy91bml4L18vZG93bmxvYWQvcGFjYXB0L21haW4uc2giCiAgICBiYXNoICIkZmlsZXBhdGgiID4gL2Rldi9udWxsCiAgZWxzZQogICAgdXJsPSJodHRwczovL21vbmRlamEuZ2l0aHViLmlvL3NocmVhZC91bml4L18vZG93bmxvYWQvcGFjYXB0LyRTQ1JJUFRfRklMRU5BTUUiCiAgICBjdXJsIC1zTCAiJHVybCIgfCBzdWRvIGJhc2ggLSA+IC9kZXYvbnVsbAogIGZpOwpmaTsKSU5TVEFMTEFUSU9OX0RFUEVOREVOQ0lFUz0oCiAgImN1cmwiCiAgImpxIgopCmZvciBERVAgaW4gIiR7SU5TVEFMTEFUSU9OX0RFUEVOREVOQ0lFU1tAXX0iOyBkbwogIGlmIFtbICIkKHN1ZG8gcGFjbWFuIC1RaSAiJERFUCIgMj4gL2Rldi9udWxsIHwgZ3JlcCBTdGF0dXMpIiAhPSAiU3RhdHVzOiBpbnN0YWxsIG9rIGluc3RhbGxlZCIgXV07IHRoZW4KICAgIHN1ZG8gcGFjbWFuIC1TICIkREVQIiA+IC9kZXYvbnVsbCB8fCBleGl0ICQ/CiAgZmk7CmRvbmU7Cl9HRVRfU0hVTklUX1JFTEVBU0VTX1VSTD0iaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9rd2FyZC9zaHVuaXQyL3JlbGVhc2VzIgpmdW5jdGlvbiBnZXRTaHVuaXRMYXN0ZXN0VmVyc2lvbigpIHsKICBfU0hVTklUX1JFTEVBU0VTX0lORk89IiQoY3VybCAtc0wgIiRHSVRIVUJfQVBJX0NVUkxfQVVUSCIgIiRfR0VUX1NIVU5JVF9SRUxFQVNFU19VUkwiIDI+JjEpIgogIF9TSFVOSVRfUkVMRUFTRVNfSU5GT19NRVNTQUdFPSIkKGVjaG8gIiRfU0hVTklUX1JFTEVBU0VTX0lORk8iIHwganEgLXIgJy5tZXNzYWdlJyAyPiYxKSIKICBfU0hVTklUX1JFTEVBU0VTX0lORk9fTUVTU0FHRV9FWElUX0NPREU9JD8KICBpZiBbICRfU0hVTklUX1JFTEVBU0VTX0lORk9fTUVTU0FHRV9FWElUX0NPREUgLWVxIDAgXTsgdGhlbgogICAgcHJpbnRmICJcZVs5MW1ceEUyXHg5Q1x4OTVcZVszOW1cbiIgPiYyCiAgICBwcmludGYgIlxuJXNcbiIgIiRfTVNHX0VSUk9SX1JFVFJJRVZJTkdfU0hVTklUX1JFTEVBU0VTX0lORk8iID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX1VSTCIgIiRfR0VUX1NIVU5JVF9SRUxFQVNFU19VUkwiID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX0VSUk9SIiAiJF9TSFVOSVRfUkVMRUFTRVNfSU5GT19NRVNTQUdFIiA+JjIKICAgIGV4aXQgJF9TSFVOSVRfUkVMRUFTRVNfSU5GT19NRVNTQUdFX0VYSVRfQ09ERQogIGZpOwogIF9QQVJTRV9TSFVOSVRfTEFTVEVTVF9WRVJTSU9OPSQoCiAgICBlY2hvICIkX1NIVU5JVF9SRUxFQVNFU19JTkZPIiB8IFwKICAgIGpxIC1yICIuWzBdLm5hbWUiIDI+JjEKICApCiAgX1BBUlNFX1NIVU5JVF9MQVNURVNUX1ZFUlNJT05fRVhJVF9DT0RFPSQ/CiAgaWYgWyAkX1BBUlNFX1NIVU5JVF9MQVNURVNUX1ZFUlNJT05fRVhJVF9DT0RFIC1uZSAwIF07IHRoZW4KICAgIHByaW50ZiAiXGVbOTFtXHhFMlx4OUNceDk1XGVbMzltXG4iID4mMgogICAgcHJpbnRmICJcbiVzXG4iICIkX01TR19FUlJPUl9QQVJTSU5HX0xBU1RFU1RfU0hVTklUX1JFTEVBU0UiID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX1VSTCIgIiRfR0VUX1NIVU5JVF9MQVRFU1RfVkVSU0lPTl9VUkwiID4mMgogICAgcHJpbnRmICIlczogJWRcbiIgIiRfTVNHX0VSUk9SX0NPREUiICIkX1BBUlNFX1NIVU5JVF9MQVNURVNUX1ZFUlNJT05fRVhJVF9DT0RFIiA+JjIKICAgIHByaW50ZiAiJXM6ICVzIiAiJF9NU0dfRVJST1IiICIkX1BBUlNFX1NIVU5JVF9MQVNURVNUX1ZFUlNJT04iID4mMgogICAgZXhpdCAkX1BBUlNFX1NIVU5JVF9MQVNURVNUX1ZFUlNJT05fRVhJVF9DT0RFCiAgZmk7CiAgX1NIVU5JVF9MQVNURVNUX1ZFUlNJT049IiQocHJpbnRmICIlcyIgIiRfUEFSU0VfU0hVTklUX0xBU1RFU1RfVkVSU0lPTiIgfCBjdXQgLWQnICcgLWYyKSIKfQpmdW5jdGlvbiBkb3dubG9hZFNodW5pdCgpIHsKICBfRE9XTkxPQURfU0hVTklUX1VSTD0iaHR0cHM6Ly9naXRodWIuY29tL2t3YXJkL3NodW5pdDIvYXJjaGl2ZS92JDEudGFyLmd6IgogIF9ET1dOTE9BRF9TSFVOSVRfT1VUUFVUPSIkKGN1cmwgLXNMICIkX0RPV05MT0FEX1NIVU5JVF9VUkwiIC1vICIkMiIgMj4mMSkiCiAgX0RPV05MT0FEX1NIVU5JVF9FWElUX0NPREU9JD8KICBpZiAgWyAkX0RPV05MT0FEX1NIVU5JVF9FWElUX0NPREUgLW5lIDAgXTsgdGhlbgogICAgcHJpbnRmICJcZVs5MW1ceEUyXHg5Q1x4OTVcZVszOW1cbiIgPiYyCiAgICBwcmludGYgIlxuJXMgdiVzXG4iICIkX01TR19FUlJPUl9ET1dOTE9BRElOR19TSFVOSVQiICIkX1NIVU5JVF9MQVNURVNUX1ZFUlNJT04iID4mMgogICAgcHJpbnRmICIlczogJXNcbiIgIiRfTVNHX1VSTCIgIiRfRE9XTkxPQURfU0hVTklUX1VSTCIgPiYyCiAgICBwcmludGYgIiVzOiAlc1xuIiAiJF9NU0dfRVJST1IiICIkX0RPV05MT0FEX1NIVU5JVF9PVVRQVVQiID4mMgogICAgZXhpdCAkX0RPV05MT0FEX1NIVU5JVF9FWElUX0NPREUKICBmaTsKfQpmdW5jdGlvbiBtYWluKCkgewogIGlmIFsgLWYgIiRfREVTVF9QQVRIIiBdIHx8IFsgLWQgIiRfREVTVF9QQVRIIiBdOyB0aGVuCiAgICBwcmludGYgIiVzICglcylcbiIgIiRfTVNHX0RFU1RfRVhJU1RTIiAiJF9ERVNUX1BBVEgiID4mMgogICAgcHJpbnRmICIlcyAnLS1kZXN0LXBhdGgnLlxuIiAiJF9NU0dfSU5ESUNBVEVfQU5PVEhFUl9ERVNUX1dJVEhfUEFSQU0iID4mMgogICAgZXhpdCAxCiAgZmk7CiAgcHJpbnRQcmVwZW5kZWRTdGRvdXQKICBwcmludGYgIiVzXG4iICIkX01TR19DSEVDS0lOR19TSFVOSVQiCiAgcHJpbnRQcmVwZW5kZWRTdGRvdXQKICBwcmludGYgIiAgJXMiICIkX01TR19SRVRSSUVWSU5HX1NIVU5JVF9MQVNURVNUX1ZFUlNJT04iCiAgZ2V0U2h1bml0TGFzdGVzdFZlcnNpb24KICBwcmludGYgIiAodiVzKSIgIiRfU0hVTklUX0xBU1RFU1RfVkVSU0lPTiIKICBwcmludGYgIiBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIKICBwcmludFByZXBlbmRlZFN0ZG91dAogIHByaW50ZiAiICAlcyAodiVzKSIgIiRfTVNHX0RPV05MT0FESU5HX1NIVU5JVCIgIiRfU0hVTklUX0xBU1RFU1RfVkVSU0lPTiIKICBkb3dubG9hZFNodW5pdCAiJF9TSFVOSVRfTEFTVEVTVF9WRVJTSU9OIiAiJF9ERVNUX0RJUlBBVEgvc2h1bml0Mi50YXIuZ3oiCiAgcHJpbnRmICIgXGVbOTJtXHhFMlx4OUNceDk0XGVbMzltXG4iCiAgcHJpbnRQcmVwZW5kZWRTdGRvdXQKICBwcmludGYgIiAgJXMiICIkX01TR19VTlpJUFBJTkdfU0hVTklUIgogIHRhciB4emYgIiRfREVTVF9ESVJQQVRIL3NodW5pdDIudGFyLmd6IiAtQyAiJF9ERVNUX0RJUlBBVEgiIHx8IGV4aXQgJD8KICBtdiAiJF9ERVNUX0RJUlBBVEgvc2h1bml0Mi0kX1NIVU5JVF9MQVNURVNUX1ZFUlNJT04vc2h1bml0MiIgIiRfREVTVF9QQVRIIgogIHJtIC1yZiAiJF9ERVNUX0RJUlBBVEgvc2h1bml0Mi0kX1NIVU5JVF9MQVNURVNUX1ZFUlNJT04iCiAgcm0gLWYgIiRfREVTVF9ESVJQQVRIL3NodW5pdDIudGFyLmd6IgogIHByaW50ZiAiIFxlWzkybVx4RTJceDlDXHg5NFxlWzM5bVxuIgp9CiEgKHJldHVybiAwIDI+L2Rldi9udWxsKSAmJiBtYWluCg==' | base64 -d)
