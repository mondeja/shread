#!/bin/bash
source <(printf 'IyEvYmluL2Jhc2gKIyAtKi0gRU5DT0RJTkc6IFVURi04IC0qLQpfU0NSSVBUX0ZJTEVOQU1FPWVzLnNoCl9NU0dfQ0hFQ0tJTkdfUEFDQVBUPSJDb21wcm9iYW5kbyBwYWNhcHQiCl9NU0dfUkVUUklFVklOR19MQVNURVNUX1ZFUlNJT049Ik9idGVuaWVuZG8gw7psdGltYSB2ZXJzacOzbiIKX01TR19JTlNUQUxMRUQ9Ikluc3RhbGFkbyIKX01TR19GT1VORF9JTlNUQUxMRUQ9IkVuY29udHJhZG8gaW5zdGFsYWRvIgpfTVNHX1VQREFURUQ9IkFjdHVhbGl6YWRvIgpfTVNHX0RFU1RfRVhJU1RTPSJFbCBhcmNoaXZvIGRlIGRlc3Rpbm8geWEgZXhpc3RlIgpfTVNHX0lORElDQVRFX0FOT1RIRVJfREVTVF9XSVRIX1BBUkFNPSJJbmRpY2Egb3RybyBkZXN0aW5vIHBhcmEgcGFjYXB0IGNvbiBlbCBwYXLDoW1ldHJvIgpJTkRFTlRfU1RSSU5HPSIiCl9ERVNUX1BBVEg9Ii91c3IvbG9jYWwvYmluL3BhY2FwdCIKZm9yIGFyZyBpbiAiJEAiOyBkbwogIGNhc2UgJGFyZyBpbgogICAgLS1pbmRlbnQpCiAgICBzaGlmdAogICAgSU5ERU5UX1NUUklORz0kMQogICAgc2hpZnQKICAgIDs7CiAgICAtLWRlc3QtcGF0aCkKICAgIHNoaWZ0CiAgICBfREVTVF9QQVRIPSQxCiAgICBzaGlmdAogICAgOzsKICBlc2FjCmRvbmUKZnVuY3Rpb24gcHJpbnRJbmRlbnQoKSB7CiAgcHJpbnRmICIlcyIgIiRJTkRFTlRfU1RSSU5HIgp9CmlmIFsgISAtZCAiL3Vzci9sb2NhbC9iaW4iIF07IHRoZW4KICBpZiBbICEgLWQgIi91c3IvYmluIiBdOyB0aGVuCiAgICBpZiBbICEgLWQgIi9iaW4iIF07IHRoZW4KICAgICAgSUZTPSc6JyByZWFkIC1yYSBfUEFUSCA8PDwgIiRQQVRIIgogICAgICBmb3IgaSBpbiAiJHtfUEFUSFtAXX0iOyBkbwogICAgICAgICAgX0RFU1RfUEFUSD0iJGkvcGFjYXB0IgogICAgICAgICAgYnJlYWsKICAgICAgZG9uZQogICAgZWxzZQogICAgICBfREVTVF9QQVRIPSIvYmluL3BhY2FwdCIKICAgIGZpOwogIGVsc2UKICAgIF9ERVNUX1BBVEg9Ii91c3IvYmluL3BhY2FwdCIKICBmaTsKZmk7CmlmIFtbICIkKHN1ZG8gZHBrZyAtcyBjdXJsIDI+IC9kZXYvbnVsbCB8IGdyZXAgU3RhdHVzKSIgIT0gIlN0YXR1czogaW5zdGFsbCBvayBpbnN0YWxsZWQiIF1dOyB0aGVuCiAgc3VkbyBhcHQtZ2V0IGluc3RhbGwgLXkgLXFxcSBjdXJsID4gL2Rldi9udWxsIHx8IGV4aXQgJD8KZmk7ClBBQ0FQVF9ET1dOTE9BRF9MSU5LPSJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vaWN5L3BhY2FwdC9uZy9wYWNhcHQiCmZ1bmN0aW9uIGdldFBhY0FwdExhc3Rlc3RWZXJzaW9uIHsKICBybSAtZiAvdG1wL3BhY2FwdAogIGN1cmwgLXNMICIkUEFDQVBUX0RPV05MT0FEX0xJTksiIC0tb3V0cHV0ICIvdG1wL3BhY2FwdCIKICBfUEFDQVBUX0xBU1RFU1RfVkVSU0lPTj0iJCg8ICIvdG1wL3BhY2FwdCIgZ3JlcCAiCn0KZnVuY3Rpb24gZ2V0UGFjQXB0Q3VycmVudFZlcnNpb24gewogIF9QQUNBUFRfQ1VSUkVOVF9WRVJTSU9OPSIiCiAgUEFDQVBUX0JJTkFSWV9QQVRIPSIkKGNvbW1hbmQgLXYgcGFjYXB0KSIKICBpZiBbICIkKGNvbW1hbmQgLXYgcGFjbWFuKSIgPSAiIiBdICYmIFsgIiQoY29tbWFuZCAtdiBwYWNhcHQpIiAhPSAiIiBdOyB0aGVuCiAgICBzdWRvIGNwICIkKGNvbW1hbmQgLXYgcGFjYXB0KSIgIiQoY29tbWFuZCAtdiBwYWNtYW4pIgogICAgUEFDQVBUX0JJTkFSWV9QQVRIPSIkKGNvbW1hbmQgLXYgcGFjbWFuKSIKICBmaTsKICBpZiBbIC1uICIkUEFDQVBUX0JJTkFSWV9QQVRIIiBdOyB0aGVuCiAgICBfUEFDQVBUX0NVUlJFTlRfVkVSU0lPTj0kKAogICAgICA8ICIkUEFDQVBUX0JJTkFSWV9QQVRIIiBncmVwICJWZXJzaW9uOiIgfCBjdXQgLWQnICcgLWYzKQogIGZpOwp9CmZ1bmN0aW9uIGluc3RhbGxQYWNBcHQgewogIHN1ZG8gY3AgIi90bXAvcGFjYXB0IiAiJF9ERVNUX1BBVEgiCiAgc3VkbyBjaG1vZCA3NTUgIiRfREVTVF9QQVRIIgogIGlmIFsgLWYgIi91c3IvbG9jYWwvYmluL3BhY21hbiIgXTsgdGhlbgogICAgc3VkbyBybSAtZiAiL3Vzci9sb2NhbC9iaW4vcGFjbWFuIgogIGZpOwogIHN1ZG8gbG4gLXN2ICIkX0RFU1RfUEFUSCIgIi91c3IvbG9jYWwvYmluL3BhY21hbiIgPiAvZGV2L251bGwgfHwgdHJ1ZQogIGlmIFsgLWYgIi90bXAvcGFjYXB0IiBdOyB0aGVuCiAgICBybSAtZiAiL3RtcC9wYWNhcHQiCiAgZmk7Cn0KZnVuY3Rpb24gbWFpbiB7CiAgaWYgWyAtZiAiJF9ERVNUX1BBVEgiIF0gfHwgWyAtZCAiJF9ERVNUX1BBVEgiIF07IHRoZW4KICAgIF9QQUNBUFRfR1JFUF9TT1VSQ0U9IiQoPCAiJF9ERVNUX1BBVEgiIGdyZXAgJyBTb3VyY2UnIHwgY3V0IC1kJyAnIC1mNCkiCiAgICBpZiBbICIkX1BBQ0FQVF9HUkVQX1NPVVJDRSIgIT0gImh0dHA6Ly9naXRodWIuY29tL2ljeS9wYWNhcHQvIiBdOyB0aGVuCiAgICAgIHByaW50ZiAiJXMgKCVzKVxuIiAiJF9NU0dfREVTVF9FWElTVFMiICIkX0RFU1RfUEFUSCIgPiYyCiAgICAgIHByaW50ZiAiJXMgJy0tZGVzdC1wYXRoJy5cbiIgIiRfTVNHX0lORElDQVRFX0FOT1RIRVJfREVTVF9XSVRIX1BBUkFNIiA+JjIKICAgICAgZXhpdCAxCiAgICBmaTsKICBmaTsKICBwcmludEluZGVudAogIHByaW50ZiAiJXNcbiIgIiRfTVNHX0NIRUNLSU5HX1BBQ0FQVC4uLiIKICBwcmludEluZGVudAogIHByaW50ZiAiICAlcyIgIiRfTVNHX1JFVFJJRVZJTkdfTEFTVEVTVF9WRVJTSU9OLi4uIgogIGdldFBhY0FwdExhc3Rlc3RWZXJzaW9uCiAgcHJpbnRmICIgKHYlcykiICIkX1BBQ0FQVF9MQVNURVNUX1ZFUlNJT04iCiAgcHJpbnRmICIgXGVbOTJtXHhFMlx4OUNceDk0XGVbMzltXG4iCiAgZ2V0UGFjQXB0Q3VycmVudFZlcnNpb24KICBpZiBbIC16ICIkX1BBQ0FQVF9DVVJSRU5UX1ZFUlNJT04iIF07IHRoZW4KICAgIGluc3RhbGxQYWNBcHQKICAgIHByaW50ZiAiICAlcyAodiVzKSIgIiRfTVNHX0lOU1RBTExFRCIgIiRfUEFDQVBUX0xBU1RFU1RfVkVSU0lPTiIKICAgIHByaW50ZiAiIFxlWzkybVx4RTJceDlDXHg5NFxlWzM5bVxuIgogIGVsaWYgWyAiJF9QQUNBUFRfQ1VSUkVOVF9WRVJTSU9OIiA9ICIkX1BBQ0FQVF9MQVNURVNUX1ZFUlNJT04iIF07IHRoZW4KICAgIHByaW50ZiAiICAlcyIgIiRfTVNHX0ZPVU5EX0lOU1RBTExFRCIKICAgIHByaW50ZiAiIFxlWzkybVx4RTJceDlDXHg5NFxlWzM5bVxuIgogIGVsc2UKICAgIHByaW50ZiAiICAlcyAodiVzIC0+IHYlcykiIFwKICAgICAgIiRfTVNHX1VQREFURUQiICIkX1BBQ0FQVF9DVVJSRU5UX1ZFUlNJT04iICIkX1BBQ0FQVF9MQVNURVNUX1ZFUlNJT04iCiAgICBzdWRvIHJtIC1mICIkUEFDQVBUX0JJTkFSWV9QQVRIIgogICAgaW5zdGFsbFBhY0FwdAogICAgcHJpbnRmICIgXGVbOTJtXHhFMlx4OUNceDk0XGVbMzltXG4iCiAgZmk7Cn0KISAocmV0dXJuIDAgMj4vZGV2L251bGwpICYmIG1haW4K' | base64 -d)
