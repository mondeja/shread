#!/bin/bash
_SCRIPT_FILENAME="$(basename "$0")" source <(printf 'IyEvYmluL2Jhc2gKIyAtKi0gRU5DT0RJTkc6IFVURi04IC0qLQpfTVNHX0NIRUNLSU5HX1BBQ0FQVD0iQ2hlY2tpbmcgcGFjYXB0IgpfTVNHX1JFVFJJRVZJTkdfTEFTVEVTVF9WRVJTSU9OPSJSZXRyaWV2aW5nIGxhdGVzdCB2ZXJzaW9uIgpfTVNHX0lOU1RBTExFRD0iSW5zdGFsbGVkIgpfTVNHX0ZPVU5EX0lOU1RBTExFRD0iRm91bmQgaW5zdGFsbGVkIgpfTVNHX1VQREFURUQ9IlVwZGF0ZWQiCl9NU0dfREVTVF9FWElTVFM9IkRlc3RpbmF0aW9uIGZpbGUgZXhpc3RzIgpfTVNHX0lORElDQVRFX0FOT1RIRVJfREVTVF9XSVRIX1BBUkFNPSJJbmRpY2F0ZSBhbm90aGVyIGRlc3RpbmF0aW9uIGZvciBwYWNhcHQgd2l0aCBwYXJhbWV0ZXIiCklOREVOVF9TVFJJTkc9IiIKX0RFU1RfUEFUSD0iL3Vzci9sb2NhbC9iaW4vcGFjYXB0Igpmb3IgYXJnIGluICIkQCI7IGRvCiAgY2FzZSAkYXJnIGluCiAgICAtLWluZGVudCkKICAgIHNoaWZ0CiAgICBJTkRFTlRfU1RSSU5HPSQxCiAgICBzaGlmdAogICAgOzsKICAgIC0tZGVzdC1wYXRoKQogICAgc2hpZnQKICAgIF9ERVNUX1BBVEg9JDEKICAgIHNoaWZ0CiAgICA7OwogIGVzYWMKZG9uZQpmdW5jdGlvbiBwcmludEluZGVudCgpIHsKICBwcmludGYgIiVzIiAiJElOREVOVF9TVFJJTkciCn0KaWYgWyAhIC1kICIvdXNyL2xvY2FsL2JpbiIgXTsgdGhlbgogIGlmIFsgISAtZCAiL3Vzci9iaW4iIF07IHRoZW4KICAgIGlmIFsgISAtZCAiL2JpbiIgXTsgdGhlbgogICAgICBJRlM9JzonIHJlYWQgLXJhIF9QQVRIIDw8PCAiJFBBVEgiCiAgICAgIGZvciBpIGluICIke19QQVRIW0BdfSI7IGRvCiAgICAgICAgICBfREVTVF9QQVRIPSIkaS9wYWNhcHQiCiAgICAgICAgICBicmVhawogICAgICBkb25lCiAgICBlbHNlCiAgICAgIF9ERVNUX1BBVEg9Ii9iaW4vcGFjYXB0IgogICAgZmk7CiAgZWxzZQogICAgX0RFU1RfUEFUSD0iL3Vzci9iaW4vcGFjYXB0IgogIGZpOwpmaTsKaWYgW1sgIiQoc3VkbyBkcGtnIC1zIGN1cmwgMj4gL2Rldi9udWxsIHwgZ3JlcCBTdGF0dXMpIiAhPSAiU3RhdHVzOiBpbnN0YWxsIG9rIGluc3RhbGxlZCIgXV07IHRoZW4KICBzdWRvIGFwdC1nZXQgaW5zdGFsbCAteSAtcXFxIGN1cmwgPiAvZGV2L251bGwgfHwgZXhpdCAkPwpmaTsKUEFDQVBUX0RPV05MT0FEX0xJTks9Imh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9pY3kvcGFjYXB0L25nL3BhY2FwdCIKZnVuY3Rpb24gZ2V0UGFjQXB0TGFzdGVzdFZlcnNpb24gewogIHJtIC1mIC90bXAvcGFjYXB0CiAgY3VybCAtc0wgIiRQQUNBUFRfRE9XTkxPQURfTElOSyIgLS1vdXRwdXQgIi90bXAvcGFjYXB0IgogIF9QQUNBUFRfTEFTVEVTVF9WRVJTSU9OPSIkKDwgIi90bXAvcGFjYXB0IiBncmVwICIKfQpmdW5jdGlvbiBnZXRQYWNBcHRDdXJyZW50VmVyc2lvbiB7CiAgX1BBQ0FQVF9DVVJSRU5UX1ZFUlNJT049IiIKICBQQUNBUFRfQklOQVJZX1BBVEg9IiQoY29tbWFuZCAtdiBwYWNhcHQpIgogIGlmIFsgIiQoY29tbWFuZCAtdiBwYWNtYW4pIiA9ICIiIF0gJiYgWyAiJChjb21tYW5kIC12IHBhY2FwdCkiICE9ICIiIF07IHRoZW4KICAgIHN1ZG8gY3AgIiQoY29tbWFuZCAtdiBwYWNhcHQpIiAiJChjb21tYW5kIC12IHBhY21hbikiCiAgICBQQUNBUFRfQklOQVJZX1BBVEg9IiQoY29tbWFuZCAtdiBwYWNtYW4pIgogIGZpOwogIGlmIFsgLW4gIiRQQUNBUFRfQklOQVJZX1BBVEgiIF07IHRoZW4KICAgIF9QQUNBUFRfQ1VSUkVOVF9WRVJTSU9OPSQoCiAgICAgIDwgIiRQQUNBUFRfQklOQVJZX1BBVEgiIGdyZXAgIlZlcnNpb246IiB8IGN1dCAtZCcgJyAtZjMpCiAgZmk7Cn0KZnVuY3Rpb24gaW5zdGFsbFBhY0FwdCB7CiAgc3VkbyBjcCAiL3RtcC9wYWNhcHQiICIkX0RFU1RfUEFUSCIKICBzdWRvIGNobW9kIDc1NSAiJF9ERVNUX1BBVEgiCiAgaWYgWyAtZiAiL3Vzci9sb2NhbC9iaW4vcGFjbWFuIiBdOyB0aGVuCiAgICBzdWRvIHJtIC1mICIvdXNyL2xvY2FsL2Jpbi9wYWNtYW4iCiAgZmk7CiAgc3VkbyBsbiAtc3YgIiRfREVTVF9QQVRIIiAiL3Vzci9sb2NhbC9iaW4vcGFjbWFuIiA+IC9kZXYvbnVsbCB8fCB0cnVlCiAgaWYgWyAtZiAiL3RtcC9wYWNhcHQiIF07IHRoZW4KICAgIHJtIC1mICIvdG1wL3BhY2FwdCIKICBmaTsKfQpmdW5jdGlvbiBtYWluIHsKICBpZiBbIC1mICIkX0RFU1RfUEFUSCIgXSB8fCBbIC1kICIkX0RFU1RfUEFUSCIgXTsgdGhlbgogICAgX1BBQ0FQVF9HUkVQX1NPVVJDRT0iJCg8ICIkX0RFU1RfUEFUSCIgZ3JlcCAnIFNvdXJjZScgfCBjdXQgLWQnICcgLWY0KSIKICAgIGlmIFsgIiRfUEFDQVBUX0dSRVBfU09VUkNFIiAhPSAiaHR0cDovL2dpdGh1Yi5jb20vaWN5L3BhY2FwdC8iIF07IHRoZW4KICAgICAgcHJpbnRmICIlcyAoJXMpXG4iICIkX01TR19ERVNUX0VYSVNUUyIgIiRfREVTVF9QQVRIIiA+JjIKICAgICAgcHJpbnRmICIlcyAnLS1kZXN0LXBhdGgnLlxuIiAiJF9NU0dfSU5ESUNBVEVfQU5PVEhFUl9ERVNUX1dJVEhfUEFSQU0iID4mMgogICAgICBleGl0IDEKICAgIGZpOwogIGZpOwogIHByaW50SW5kZW50CiAgcHJpbnRmICIlc1xuIiAiJF9NU0dfQ0hFQ0tJTkdfUEFDQVBULi4uIgogIHByaW50SW5kZW50CiAgcHJpbnRmICIgICVzIiAiJF9NU0dfUkVUUklFVklOR19MQVNURVNUX1ZFUlNJT04uLi4iCiAgZ2V0UGFjQXB0TGFzdGVzdFZlcnNpb24KICBwcmludGYgIiAodiVzKSIgIiRfUEFDQVBUX0xBU1RFU1RfVkVSU0lPTiIKICBwcmludGYgIiBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIKICBnZXRQYWNBcHRDdXJyZW50VmVyc2lvbgogIGlmIFsgLXogIiRfUEFDQVBUX0NVUlJFTlRfVkVSU0lPTiIgXTsgdGhlbgogICAgaW5zdGFsbFBhY0FwdAogICAgcHJpbnRmICIgICVzICh2JXMpIiAiJF9NU0dfSU5TVEFMTEVEIiAiJF9QQUNBUFRfTEFTVEVTVF9WRVJTSU9OIgogICAgcHJpbnRmICIgXGVbOTJtXHhFMlx4OUNceDk0XGVbMzltXG4iCiAgZWxpZiBbICIkX1BBQ0FQVF9DVVJSRU5UX1ZFUlNJT04iID0gIiRfUEFDQVBUX0xBU1RFU1RfVkVSU0lPTiIgXTsgdGhlbgogICAgcHJpbnRmICIgICVzIiAiJF9NU0dfRk9VTkRfSU5TVEFMTEVEIgogICAgcHJpbnRmICIgXGVbOTJtXHhFMlx4OUNceDk0XGVbMzltXG4iCiAgZWxzZQogICAgcHJpbnRmICIgICVzICh2JXMgLT4gdiVzKSIgXAogICAgICAiJF9NU0dfVVBEQVRFRCIgIiRfUEFDQVBUX0NVUlJFTlRfVkVSU0lPTiIgIiRfUEFDQVBUX0xBU1RFU1RfVkVSU0lPTiIKICAgIHN1ZG8gcm0gLWYgIiRQQUNBUFRfQklOQVJZX1BBVEgiCiAgICBpbnN0YWxsUGFjQXB0CiAgICBwcmludGYgIiBcZVs5Mm1ceEUyXHg5Q1x4OTRcZVszOW1cbiIKICBmaTsKfQohIChyZXR1cm4gMCAyPi9kZXYvbnVsbCkgJiYgbWFpbgo=' | base64 -d)
